<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>A Study of Reinforcement Learning in the Iterated Prisoner&#39;s Dilemma by lijiyao919</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">A Study of Reinforcement Learning in the Iterated Prisoner&#39;s Dilemma</h1>
      <h2 class="project-tagline">Defect or Cooperation...This is a question!!!</h2>
      <a href="https://github.com/lijiyao919/IPD-RL" class="btn">View on GitHub</a>
      <a href="https://github.com/lijiyao919/IPD-RL/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/lijiyao919/IPD-RL/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="abstract" class="anchor" href="#abstract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Abstract</h1>

<p>This Work considers a reinforcement learning (RL) agent in the Iterated Prisoner‚Äôs Dilemma (IPD). We have implemented RL with three different kinds of methods : Dynamic Programming(DP), Temporal-Difference(TD) and Monte Carlo (MC) respectively. The purpose of the work is to test the performance of such various types of RL agents. We hope that RL agent may adjust its strategy to do the best response when it competes with a fixed strategy player, on the other hand, RL agent is also expected to elicit cooperation when it plays with itself or other RL agents, which is the best way to achieve more utility for himself.</p>

<h1>
<a id="problem-description" class="anchor" href="#problem-description" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Problem Description</h1>

<p>Two players play Prisoner's Dilemma more than once in succession and they can remember previous actions of their opponent and choose their strategy accordingly, but they do not exactly know when the iterated games would be over. Both players are trying to maximize their own utility. </p>

<h2>
<a id="rules-of-prisoners-dilemma" class="anchor" href="#rules-of-prisoners-dilemma" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rules of Prisoner‚Äôs Dilemma</h2>

<ul>
<li>If both players confess (Defect), they both will be sentence to 4 years respectively. Other words, both of them can earn utility for 1 respectively</li>
<li>If one player confess (Defect) but the other remain silence (Cooperate), the player who confess will be free whereas the other will be punished for 5 years. Other words, the player who defect may earns 5 utility while the player who cooperate  gets nothing</li>
<li>If both players remain silent (Cooperate), they both will be sentence to 2 years respectively. Other words, both of them can earn utility for 3 respectively
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/prison.png" alt="Fig1">
</li>
</ul>

<h1>
<a id="method" class="anchor" href="#method" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Method</h1>

<p>Reinforcement Learning is learning how to map situations to actions so as to maximize the reward signal from the environment. As Figure shown below, agent perceives Reward and State value and constructs its own internal state by reshaping the external state from environment. Then the internal state and the reward value are used to update the value of Q table by three different types of method: Dynamic Programming(DP), Temporal Difference(TD) and Monte Carlo(MC) respectively.  In the Action Selection, there is an exploration and exploitation problem. Boltzmann Distribution is used as a soft-max function to calculate the probability that determine whether agent should choose action of maxùëÑ or a random action
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/RL.png" alt="Fig2"></p>

<ul>
<li>
<strong>Dynamic Programming</strong> (<strong>DP</strong>): This method is supposed to know the model of the environment. It Uses the future estimation (future Q value) to update current knowledge of the state (current Q value), which can be used to choose action in the future.</li>
<li>
<strong>Temporal Difference</strong> (<strong>TD</strong>): This method do not need to know the model of the environment. It used the present knowledge(present Q value) to update the past experience (previous Q value), which can be used to choose action in future.</li>
<li>
<strong>Monte Carlo</strong> (<strong>MC</strong>): This method do not need to know the model of the environment. It learns knowledge (the Q values )from the samples of each playout, and uses such knowledge to choose its action.</li>
</ul>

<h1>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Results</h1>

<p>In all of the experiments below, TDBot, DPBot and MCBot represents RL Agents implemented by TD, DP and MC separately. The discount rate of all RL agents is set as 0.9. The temperature function of Boltzmann Distribution is t=20¬∑„Äñ0.999„Äó^ùëõ where n is the number of iterated games. The learning rate of the TDBot is decreasing as the iteration number goes up.</p>

<p>First of all, 3 tournaments that use Robin-Round style are held to test each RL Agent playing with 6 other Fixed Strategy Players. In the tournament, each of the two players play 10000 rounds in one match  and the Robin-Round repeats 30 times. Figures below show each player‚Äôs mean score and its distribution in every tournament separately. 
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/TDBot.png" alt="fsp-td">
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/DPBot.png" alt="fsp-dp">
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/MCBot.png" alt="fsp-mc"></p>

<p>Secondly, the homogeneous RL Agents matches are held. Here homogeneous means the agent plays with itself, so matches are TD vs. TD, DP vs. DP and MC vs. MC. Every two of the agent play 10000 times in each match. The bar chart below shows how many times can converge  to cooperation in 100 matches. The line graph shows the cooperation rate per iteration in a match that converge to cooperation. 
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/homo.png" alt="homo"></p>

<p>At last, heterogenous RL Agents matches are held. Heterogeneous here means agents implement their RL with different methods. So matches are TD vs. DP, TD vs. MC and DP vs. MC. The line graph below shows the cooperation rate per iteration in all matches. Also, tournament (10000 iterations for one match, the robin-round repeat 30 times)is also held between heterogenous RL agents. The payoff graph is shown as a heap graph.
<img src="https://raw.githubusercontent.com/lijiyao919/Figure/master/heter.png" alt="heter"></p>

<h1>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h1>

<ul>
<li>All three types of RL agents learned to play optimally against the Fixed Strategy Agents. Playing against Fixed Strategy Agents is analogous to learning in a single agent environment, because Fixed Strategy Agents does not learn.</li>
<li>Cooperation could be elicited when RL agent plays with itself. This is mainly because they share the same learning mechanism.</li>
<li>Cooperation seldom emerged in experiments when different types of RL agents since agents use a different decision scheme.</li>
<li>In the tournament among heterogeneous RL Agents, DPBot and MCBot are apparently weaker than TDBot. The reason might be the transitional model of DPBot cannot predict the true environment precisely in a non-stationary environment and  the samples of MCBot are relatively isolated in episode.</li>
</ul>

<h1>
<a id="reference" class="anchor" href="#reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reference</h1>

<ul>
<li>R.Axelrod. The Evolution of Cooperation. Basic Books, New York, 1984</li>
<li>Sutton, R.S and Barto, A.G Reinforcement learning: An introduction. MIT Press,   Cambridge, Massachusetts, 1998</li>
<li>Stuart J. Russell,¬†Peter Norvig.¬†Artificial Intelligence: A Modern Approach¬†(Third ed.).¬†Prentice Hall. 2010</li>
<li>Axelrod-Python Package: <a href="https://github.com/Axelrod-Python/Axelrod">https://github.com/Axelrod-Python/Axelrod</a>
</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/lijiyao919/IPD-RL">A Study of Reinforcement Learning in the Iterated Prisoner&#39;s Dilemma</a> is maintained by <a href="https://github.com/lijiyao919">lijiyao919</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
